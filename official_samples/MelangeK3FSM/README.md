# Presentation
FSM is a simple Finite State Machine DSL implementing a mealy machine semantics.

This implementation focuses on illustrating the hierarchy of languages: a base FSM with editor support 
considered as a _legacy_ language (ie. as if it was developped by thirdparties)
and an eXecutable Sequential FSM (XSFSM) with animation support built by extension of the FSM language.

![Concepts of the languages.](https://github.com/eclipse/gemoc-studio/raw/master/official_samples/sample.deployers/plugins/org.eclipse.gemoc.gemoc_language_workbench.sample.deployer/figures-gen/src/main/plantuml/MelangeK3FSM_language_concepts_figure.png)

*General view: Concepts of the languages..*

## Installation

This language can be installed by importing the projects of this git repository in a GEMOC Studio. 
The language projects must be imported in the first workspace (language wokbench), 
then launch a new Eclipse instance from the first (ie. as a modeling workbench where the language is deployed) 
and then import the sample models. 
(see [GEMOC documentation](http://gemoc.github.io/gemoc-studio/publish/guide/html_single/Guide.html#deploy-languages-chapter) 
for more details about the language deployment process)

Alternatively, this language is part of the basic example of GEMOC and is directly available in the GEMOC Studio. 
Simply, go to _File > New > Example..._ and use the wizards to install the MelangeK3FSM projects in the language workbench and modeling workbench. 

# Developper documentation (Language Designer) ![GEMOC Language Logo](http://gemoc.github.io/gemoc-studio/publish/guide/html_single/images/icons/IconeGemocLanguage_16.png)

## Organization of the code
Main eclipse plugins:
- _org.eclipse.gemoc.example.melangek3fsm.fsm_ contains the definition of the FSM language using the Melange language.
- _org.eclipse.gemoc.example.melangek3fsm.fsm.design_ contains the graphical concrete syntax of FSM, using Sirius. It defines only the layer for edition.
- _org.eclipse.gemoc.example.melangek3fsm.fsm.k3dsa_ contains the operational semantics of FSM (ie. the interpreter), using the Kermeta3 language.
- _org.eclipse.gemoc.example.melangek3fsm.fsm.model_ contains the metamodel of FSM, using the Ecore language.
- _org.eclipse.gemoc.example.melangek3fsm.fsm.model.edit_ contains EMF edition support. It is used to customize the various views in Sirius and in the simulator (for example by providing custom icons in the various views)
- _org.eclipse.gemoc.example.melangek3fsm.fsm.model.editor_ contains EMF basic tree editor for FSM models.
- _org.eclipse.gemoc.example.melangek3fsm.xsfsm_ contains the definition of the XSFSM language using the Melange language. Basically, it inherits from FSM language and add the aspects defined in the k3dsa project. 
- _org.eclipse.gemoc.example.melangek3fsm.xsfsm.design_ contains the graphical concrete syntax of XSFSM, using Sirius. It extends fsm.design editor by adding the layers used by the debug/animation.
- _org.eclipse.gemoc.example.melangek3fsm.xsfsm.trace_ contains the trace metamodel automatically generated from the semantics. It is used by the omniscient debugger to support __StepBack__ instruction and to display an interactive timeline of the execution.
- _org.eclipse.gemoc.example.melangek3fsm.xsfsm.xsfsm_ contains the language runtime generated by Melange for XSFSM, ie. a new Ecore model that contains both static elements (from org.eclipse.gemoc.example.melangek3fsm.fsm.model) 
and dynamic features (from org.eclipse.gemoc.example.melangek3fsm.fsm.k3dsa).

## Relation between FSM and XSFSM languages
The following figure presents an overview of the main artefacts in the projects:
- the base language _fsm_ is built by _fsm.melange_ from the _fsm.ecore_. As it use the _legacy_ modifier (ie. it doesn't modifies the ecore definitions) the java classes from the ecore are directly reused as implementation for the fsm language;
- the aspects in _fsm.k3dsa_ extends the base classes;
- the _xsfsm.melange_ file defines the _xsfsm_ language. It inherits from _fsm_ and add the _fsm.k3dsa_ aspects. This will generate the java implementation classes for the resulting xsfsm language.

![Ecore, melange, packages and classes view.](https://github.com/eclipse/gemoc-studio/raw/master/official_samples/sample.deployers/plugins/org.eclipse.gemoc.gemoc_language_workbench.sample.deployer/figures-gen/src/main/plantuml/MelangeK3FSM_language_figure.png)
*Main artefacts view: Ecore, melange, packages and runtime classes.*

Please note that for simplification of the diagram, the associations that doesn't represent a containment, have been represented as attributes rather than links.

## Note about current limitations/issues
Currently, Melange doesn't automatically copy the .edit project from FSM to XSFSM. As a consequence, the customized icons defined in _fsm.model.edit_ are 
not used in the debug views (Stack and variable views) and replaced by default icons.

__Workaround:__ you can generate the edit project from _XSFSM.genmodel_ and copy the icons from _fsm.model.edit_ to _xsfsm.xsfsm.edit_.


# User Documentation (Model Designer) ![GEMOC Model Logo](http://gemoc.github.io/gemoc-studio/publish/guide/html_single/images/icons/IconeGemocModel_16.png)

The projects in modeling workbench contains some sample models.

you can run them from the modeling workbench by creating a launch configuration and using the GEMOC Sequential Engine.
(see model details about launching the sequential engine in [GEMOC Documentation](http://gemoc.github.io/gemoc-studio/publish/guide/html_single/Guide.html#_executing_model_with_the_indexterm_primary_sequential_engine_primary_indexterm_sequential_engine)).

# Additionnal resources and related links
Please note that some of the document listed here may describe an early implementation of the language and may slightly differ from the current version.
- [Melange documentation](http://melange-lang.org/)
